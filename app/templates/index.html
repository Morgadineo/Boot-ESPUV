{% extends "base.html" %}

{% block content %}
<main class="main-content">
    <!-- Área do Gráfico -->
    <div id="grafico-uv">
        <canvas id="uvChart" height="150" ></canvas>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
    const ctx = document.getElementById('uvChart').getContext('2d');
    
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: {{ labels|tojson }},
            datasets: [{
                label: 'Registros por dia',
                data: {{ values|tojson }},
                backgroundColor: '#9600ff',
                borderColor: '#7600cc',
                borderWidth: 2
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        precision: 0,  // Força números inteiros
                        stepSize: 1    // Incremento de 1 em 1
                    },
                    grid: {
                        display: true,
                        drawOnChartArea: false,  // Remove linhas internas
                        drawTicks: true          // Mantém linhas no topo
                    }
                },
            },
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return context.parsed.y + ' registro(s)';
                        }
                    }
                }
            }
        }
    });
});
    </script>
    </div>

    <!-- Tabela de Dados -->
    <div id="container-table">
    <table id="table-dinamic">
        <thead>
            <tr>
                <th>ID</th>
                <th>Arduino</th>
                <th>Data</th>
                <th>Localização</th>
                <th>Frequência<br>(mW/cm²)</th>
            </tr>
        </thead>
        <tbody>
            {% for uv_register, location in registers %}
            <tr>
                <td>{{ uv_register.id }}</td>
                <td>Arduino #{{ uv_register.arduino_id }}</td>
                <td>{{ uv_register.register_date.strftime('%d/%m/%Y %H:%M') }}</td>
                <td>
                    <div class="location-cell">
                        <span class="city">{{ location.city }}</span>
                        <span class="state">{{ location.state }}</span>
                    </div>
                </td>
                <td class="frequency">{{ uv_register.frequency }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    </div>
</main>
{% endblock %}

